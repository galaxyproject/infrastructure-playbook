---

authorized_keys_unprivileged:
  authorized: "{{ ['frontera_auto_key'] + galaxy_team_users }}"

pulsar_clean_jobs_percent_full_function: |
  python3 <<EOF
  import subprocess
  line = subprocess.check_output("lfs quota -q -u xcgalaxy /scratch1".split(), text=True).splitlines()[-1].strip().split()
  used_kb, limit_kb, used_inodes, limit_inodes = [int(x) for x in (line[1], line[3], line[5], line[7])]
  size_ratio = 0
  inodes_ratio = 0
  if limit_kb != 0:
      size_ratio = used_kb / limit_kb
  if limit_inodes != 0:
      inodes_ratio = used_inodes / limit_inodes
  print(round(100 * max(size_ratio, inodes_ratio)))
  EOF
