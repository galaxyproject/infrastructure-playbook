---

pulsarservers_group_authorized_key_users:
  - name: g2test
    authorized: "{{ galaxy_team_users }}"
  - name: g2main
    authorized: "{{ galaxy_team_users }}"

pulsarservers_group_packages:
  - vim
  - git
  - tmpwatch
  - pdsh
  # Pulsar deps
  - '@development tools'
  - libffi-devel
  - libcurl-devel
  - nss-devel
  - openssl-devel
  #- slurm-drmaa
  # this probably won't work until after Slurm is installed
  - https://github.com/natefoo/slurm-drmaa/releases/download/1.1.4/slurm-drmaa-1.1.4-22.05.el9.x86_64.rpm

pulsarservers_group_files:
  - src: files/admin/pulsar-clean-jobs
    dest: /usr/local/bin/pulsar-clean-jobs
    mode: "0755"
    owner: root
    group: root
  - src: files/admin/pulsar-staging-fds
    dest: /usr/local/bin/pulsar-staging-fds
    mode: "0755"
    owner: root
    group: root

pulsarservers_group_directories:
  - path: /srv/pulsar/test
    owner: g2test
    group: G-803372
  - path: /srv/pulsar/test/log
    owner: g2test
    group: G-803372
  - path: /srv/pulsar/main
    owner: g2main
    group: G-803372
  - path: /srv/pulsar/main/log
    owner: g2main
    group: G-803372

#pulsarservers_group_crontabs:
#  - id: pulsar_clean_jobs
#    name: Clean Test Pulsar Jobs
#    user: g2test
#    minute: 30
#    job: /usr/local/bin/pulsar-clean-jobs /jetstream2/scratch/test/jobs >> /srv/pulsar/test/log/cleanup-jobs.log
#  - id: pulsar_clean_jobs
#    name: Clean Main Pulsar Jobs
#    user: g2main
#    minute: 00
#    job: /usr/local/bin/pulsar-clean-jobs /jetstream2/scratch/main/jobs >> /srv/pulsar/main/log/cleanup-jobs.log
#  - id: clean_amqp_consume
#    name: Clean Test AMQP consume dir
#    user: g2test
#    minute: "0"
#    hour: "2"
#    job: "/usr/bin/tmpwatch 7d /srv/pulsar/test/var/persisted_data/amqp_ack-jetstream2/consume"
#  - id: clean_amqp_consume
#    name: Clean Main AMQP consume dir
#    user: g2main
#    minute: "30"
#    hour: "2"
#    job: "/usr/bin/tmpwatch 7d /srv/pulsar/main/var/persisted_data/amqp_ack-jetstream2/consume"
#  - id: pulsar_staging_fds
#    name: Collecting Pulsar staging file descriptor counts
#    user: rocky
#    job: "/usr/local/bin/pulsar-staging-fds 2>&1 >> /tmp/pulsar-collect-fds.log"
