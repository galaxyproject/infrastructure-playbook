---

- name: Tool Shed Servers
  hosts: tool_shed_servers
  roles:
    - role: tool_shed_defaults
      tags: general
    - role: galaxyproject.general.virtual
      tags: general
    - role: galaxyproject.general.locale
      tags: general
    - role: galaxyproject.general.packages
      tags: general
    - role: galaxyproject.general.users
      tags: general
    - role: galaxyproject.general.paths
      tags: general
    - role: galaxyproject.general.copy
      tags: general
    - role: galaxyproject.postfix
      tags: postfix
    - role: galaxyproject.postgresql
      tags: postgres
    - role: galaxyproject.postgresql
      tags: postgres
    - role: galaxyproject.postgresql_objects
      become: true
      become_user: postgres
      tags: postgres
    - role: tool_shed_privileged
      become: true
      become_user: "{{ tool_shed_privileged_user }}"
      tags: shed
    # TODO: https://github.com/galaxyproject/galaxy/issues/18205
    #- role: tool_shed_unprivileged
    #  become: true
    #  become_user: "{{ tool_shed_user }}"
    #  tags: shed
    - role: tool_shed_root
      tags: shed
    - role: galaxyproject.general.cron
      tags: general
    - role: galaxyproject.nginx
      tags: nginx
    - role: error_pages
      tags: nginx
    - role: dj-wasabi.telegraf
      tags: telegraf
